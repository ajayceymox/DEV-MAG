<?php /** * Copyright Â© 2021 Zazmic. All rights reserved. */ ?> <div class="box-s1"><div class="row b4"><div class="col-6 col-left"><img src='<?= $block->escapeHtml( $block->getViewFileUrl('Zazmic_AmazonMCF::images/settings.jpg') ); ?>'></div><div class="col-6 col-right"><?php $webSites = $block->getWebsites(); $k = 0; $j= 0; foreach ($webSites as $key => $value) { $key = $value[0]; if (!empty($block->getConfigData('spapi_oauth_code', $key))): $selectedStatus = $block->getConfigData('shipment_sync_status', $key); $checked = ''; $activeClass = ''; if ($selectedStatus == 1) { $checked= "checked"; $activeClass = 'show-select'; } $selectedInventoryStatus = $block->getConfigData('auto_inventory', $key); $checkedInventory = ''; $activeClassInventory = ''; if ($selectedInventoryStatus == 1) { $checkedInventory= "checked"; $activeClassInventory = 'show-select'; } ?> <div class="fieldset-wrapper admin__collapsible-block-wrapper section-config" data-index="shipmentstatus_details"><div rel="#tab_contents_<?= $block->escapeHtml($key);?>" class="fieldset-wrapper-title tab" data-content-id="tab_contents_<?=$block->escapeHtml($key);?>" ><strong class="admin__collapsible-title"><span data-bind="i18n: label"><?=$block->escapeHtml($value[2]);?></span></strong></div><div id="tab_contents_<?= $block->escapeHtml($key);?>" class="admin__fieldset-wrapper-content admin__collapsible-content tab_contents"><input type="hidden" name="shipment_status[<?= $block->escapeHtml($key);?>][scope_id]" value="<?= $block->escapeHtml($key);?>" data-form-part="shipmentstatus_form" id="shipment_status[<?= $block->escapeHtml($key);?>][scope_id]" /><input type="hidden" name="carrier[<?= $block->escapeHtml($key);?>][scope_id]" value="<?= $block->escapeHtml($key);?>" data-form-part="shipmentstatus_form" id="carrier[<?= $block->escapeHtml($key);?>][scope_id]" /><div class="section-config"><div rel="#tab_contents_status<?= $block->escapeHtml($key);?>" class="fieldset-wrapper-title tab_sub section-config" data-content-id ="tab_contents_status<?= $block->escapeHtml($key);?>" ><strong class="admin__collapsible-title"><span data-bind="i18n: label"><?= $block->escapeHtml(__('Order Status Sync')) ?></span></strong></div><div id="tab_contents_status<?= $block->escapeHtml($key);?>" class="admin__fieldset-wrapper-content admin__collapsible-content tab_contents"><fieldset class="admin__fieldset methods-outer admin__field-switch"><div class="admin__field custom-field-switch sync-status"><div class="admin__field-control"><div class="admin__actions-switch" data-role="switcher"><input <?= $block->escapeHtml($checked); ?> value="<?= $block->escapeHtml($selectedStatus);?>" type="checkbox" class="admin__actions-switch-checkbox sync_status" name="shipment_status[<?= $block->escapeHtml($key);?>][shipment_sync_status]" id="shipment_status[<?= $block->escapeHtml($key);?>][shipment_sync_status]" data-form-part="shipmentstatus_form" data-index="<?= $block->escapeHtml($key);?>"><label class="admin__actions-switch-label" for="shipment_status[<?= $block->escapeHtml($key);?>][shipment_sync_status]"><span class="admin__actions-switch-text" data-text-on="Yes" data-text-off="No"></span></label></div></div><div class="admin__field-label"><label><span><?= $block->escapeHtml(__('Auto sync')) ?></span></label></div></div><div class="admin__field interval-select <?=$block->escapeHtml($activeClass);?>" data-index="shipment_sync_interval" id="interval-select-<?= $block->escapeHtml($key);?>"><div class="admin__field-label"><label><span><?= $block->escapeHtml(__('Order status sync')) ?></span></label></div><div class="admin__field-control"><?php $selectedValue = $block->getConfigData('shipment_sync_interval', $key); $selectOptions = $block->getOptions();?> <select data-form-part="shipmentstatus_form" class="admin__control-select" name="shipment_status[<?= $block->escapeHtml($key);?>][shipment_sync_interval]" ><?php foreach ($selectOptions as $key1 => $value1) { $selected = ''; if ($selectedValue == $key1) { $selected= "selected"; } ?> <option data-title="<?= $block->escapeHtml($value1)?>" value="<?= $block->escapeHtml($key1) ?>" <?= $block->escapeHtml($selected) ?>><?= $block->escapeHtml($value1) ?></option><?php } ?></select></div></div></fieldset></div></div><div class="section-config"><div rel="#tab_contents_inventory<?= $block->escapeHtml($j);?>" class="fieldset-wrapper-title tab_sub section-config" data-content-id ="tab_contents_inventory<?=$block->escapeHtml($j);?>" ><strong class="admin__collapsible-title"><span data-bind="i18n: label"><?= $block->escapeHtml(__('Inventory Sync')) ?></span></strong></div><div id="tab_contents_inventory<?=$block->escapeHtml($j);?>" class="admin__fieldset-wrapper-content admin__collapsible-content tab_contents"><input type="hidden" name="inventory[<?= $block->escapeHtml($key);?>][scope_id]" value="<?= $block->escapeHtml($key);?>" data-form-part="shipmentstatus_form" id="inventory[<?= $block->escapeHtml($key);?>][scope_id]" /><fieldset class="admin__fieldset methods-outer admin__field-switch"><?= $block->getLayout()->createBlock(Zazmic\AmazonMCF\Block\Adminhtml\Inventory\SyncButton::class) ->setWebsite($key)->toHtml() ?> <div class="admin__field sync-status custom-field-switch no-label"><div class="admin__field-control"><div class="admin__actions-switch" data-role="switcher"><input <?= $block->escapeHtml($checkedInventory); ?> value="<?= $block->escapeHtml($selectedInventoryStatus);?>" type="checkbox" class="admin__actions-switch-checkbox sync_status" name="inventory[<?= $block->escapeHtml($key);?>][auto_inventory]" id="inventory[<?= $block->escapeHtml($key);?>][auto_inventory]" data-form-part="shipmentstatus_form" data-index="inventory-<?=$block->escapeHtml($key);?>"><label class="admin__actions-switch-label" for="inventory[<?= $block->escapeHtml($key);?>][auto_inventory]"><span class="admin__actions-switch-text" data-text-on="Yes" data-text-off="No"></span></label></div></div><div class="admin__field-label"><label><span><?= $block->escapeHtml(__('Enable')) ?></span></label></div></div><div class="admin__field interval-select <?= $block->escapeHtml($activeClassInventory);?> show-inventory-<?=$block->escapeHtml($key);?>" data-index="shipment_sync_interval" id ="interval-select-<?= $block->escapeHtml($key);?>"><div class="admin__field-label"><label><span><?= $block->escapeHtml(__('Inventory sync')) ?></span></label></div><div class="admin__field-control"><?php $selectedValueInventory = $block->getConfigData('inventory_sync_interval', $key); $selectOptionsInventory = $block->getOptions();?> <select data-form-part="shipmentstatus_form" class="admin__control-select" name="inventory[<?=$block->escapeHtml($key);?>][sync_interval]" ><?php foreach ($selectOptionsInventory as $keyInv => $valueInv) { $selectedInv = ''; if ($selectedValueInventory == $keyInv) { $selectedInv= "selected"; } ?> <option data-title="<?=$block->escapeHtml($valueInv) ?>" value="<?= $block->escapeHtml($keyInv) ?>" <?= $block->escapeHtml($selectedInv) ?>><?= $block->escapeHtml($valueInv) ?></option><?php } ?></select></div></div></fieldset></div></div><div class="section-config"><div rel="#tab_contents_settings<?= $block->escapeHtml($k);?>" class="fieldset-wrapper-title tab_sub section-config" data-content-id ="tab_contents_settings<?= $block->escapeHtml($k);?>" ><strong class="admin__collapsible-title"><span data-bind="i18n: label"><?= $block->escapeHtml(__('Fulfillment Settings')) ?></span></strong></div><?php $shippingShip = $block->getConfigData('shipping_config_ship', $key); $shippingExclusive = $block->getConfigData('shipping_config_exclusive', $key); $shippingDefault = explode(",", $block->getConfigData('shipping_config_default_method', $key)); $mcfShippingDefault = $block->getConfigData('shipping_config_default_method', $key); if( $mcfShippingDefault != '') { $shippingDefault = $block->getUnserialized($mcfShippingDefault); } else { $shippingDefault = []; } $shippingAmazonDefault = $block->getConfigData('shipping_config_default_amazon_method', $key); $shippingChecked1 = ''; $shippingActiveClass1 = ''; $shippingChecked2 = ''; $shippingActiveClass2 = ''; if ($shippingShip == 1) { $shippingChecked1 = "checked"; $shippingActiveClass1 = 'show-select'; } if ($shippingExclusive == 1) { $shippingChecked2 = "checked"; $shippingActiveClass2 = 'show-select'; } ?> <div id="tab_contents_settings<?= $block->escapeHtml($k);?>" class="admin__fieldset-wrapper-content admin__collapsible-content tab_contents"><fieldset class="admin__fieldset methods-outer admin__field-switch"><div class="admin__field custom-field-switch sync-status <?= $block->escapeHtml($shippingActiveClass2);?>" ><div class="admin__field-control" ><div class="admin__actions-switch" data-role="switcher"><input <?= $block->escapeHtml($shippingChecked2);?> data-form-part="shipmentstatus_form" value="<?= $block->escapeHtml($shippingExclusive);?>" type="checkbox" class="admin__actions-switch-checkbox sync_status" name="carrier[<?= $block->escapeHtml($key);?>][exclusive]" id="carrier[<?= $block->escapeHtml($key);?>][exclusive]" data-index="carrier-<?= $block->escapeHtml($key);?>"><label class="admin__actions-switch-label" for="carrier[<?= $block->escapeHtml($key);?>][exclusive]"><span class="admin__actions-switch-text" data-text-on="Yes" data-text-off="No"></span></label></div></div><div class="admin__field-label _with-tooltip admin__custom-tooltip"><label><span><?= $block->escapeHtml(__('Make Amazon exclusive shipper')) ?></span></label> <div class="admin__field-tooltip"><a class="admin__field-tooltip-action action-help" target="_blank" tabindex="1"></a> <div class="admin__field-tooltip-content"><?=$block->escapeHtml(__(" When YES is selected - and amazon can complete shipping for ALL items in the cart - Amazon will be the exclusive shipping option. When NO is selected, customer may select either Magento default shipping methods, or Amazon MCF options")) ?></div></div></div></div><div class="admin__field custom-field-switch <?= $block->escapeHtml($shippingActiveClass2);?> show-carrier-<?= $block->escapeHtml($key);?> " ><div class="admin__field-control" ><div class="admin__actions-switch" data-role="switcher"><input <?= $block->escapeHtml($shippingChecked1);?> data-form-part="shipmentstatus_form" value="<?= $block->escapeHtml($shippingShip);?>" type="checkbox" class="admin__actions-switch-checkbox sync_status_backup" name="carrier[<?= $block->escapeHtml($key);?>][ship]" id="carrier[<?= $block->escapeHtml($key);?>][ship]" data-index="carrier-<?= $block->escapeHtml($key);?>"><label class="admin__actions-switch-label" for="carrier[<?= $block->escapeHtml($key);?>][ship]"><span class="admin__actions-switch-text" data-text-on="Yes" data-text-off="No"></span></label></div></div><div class="admin__field-label _with-tooltip admin__custom-tooltip"><label><span><?= $block->escapeHtml(__('Enable backup ship option for partial MCF orders')) ?></span></label> <div class="admin__field-tooltip"><a class="admin__field-tooltip-action action-help" target="_blank" tabindex="1"></a> <div class="admin__field-tooltip-content"><?= $block->escapeHtml(__("When Amazon cannot complete shipping for all items in the cart (ie, Product SKUs are not mapped) items will be fulfilled by Active Magento methods selected below.")) ?></div></div></div></div><div class="admin__field <?= $block->escapeHtml($shippingActiveClass2);?> show-carrier-<?=$block->escapeHtml($key);?> carrier-<?=$block->escapeHtml($key);?> custom-data-table"><table class="data-table admin__control-table" id="shipment_tracking_info"><thead><tr class="headings"><th class="col-carrier"><?= $block->escapeHtml(__('Enable')) ?></th><th class="col-title"><?= $block->escapeHtml(__('Active Shipping')) ?></th><th class="col-number"><?= $block->escapeHtml(__('Default shipping speed for partial MCF orders')) ?></th></tr></thead><?php $activeMethods = $block->getActiveMethods();?> <tfoot><?php foreach ($activeMethods as $keys => $values): $shippingSelected =''; if (!empty($shippingDefault) && array_key_exists($keys, $shippingDefault)) { $shippingSelected = "checked = 'checked'"; } ?> <tr><td class="col-carrier"><input <?= $block->escapeHtml($shippingSelected);?> data-form-part="shipmentstatus_form" value="1" type="checkbox" class="admin__actions-switch-checkbox" name="carrier[<?= $block->escapeHtml($key);?>][default_method][<?=$keys?>]" id="carrier[<?= $block->escapeHtml($key);?>][default_method][<?=$keys?>]" ><label class="admin__actions-switch-label" for="carrier[<?= $block->escapeHtml($key);?>][default_method][<?=$keys?>]"></label></td><td class="col-carrier"><?= $block->escapeHtml($values);?></td><td class="col-carrier"><?php $amazonMethods = $block->getAmazonMethods(); ?> <div class="admin__field custom-field-switch"><div class="admin__field-control _with-tooltip admin__custom-tooltip"><select data-form-part="shipmentstatus_form" id="carrier[<?= $block->escapeHtml($key);?>][default_amazon_method][<?=$keys?>]" name="carrier[<?= $block->escapeHtml($key);?>][default_amazon_method][<?=$keys?>]" class=" select select admin__control-select"><?php foreach ($amazonMethods as $amazonKeys => $amazonValues): $shippingAmazonSelected =''; if (!empty($shippingDefault[$keys]) && $amazonKeys == $shippingDefault[$keys] ) { $shippingAmazonSelected = "selected = 'selected'"; } ?> <option value="<?= $block->escapeHtml($amazonKeys);?>" <?= $block->escapeHtml($shippingAmazonSelected);?> ><?= $block->escapeHtml($amazonValues);?></option><?php endforeach; ?></select> <div class="admin__field-tooltip"><a class="admin__field-tooltip-action action-help" target="_blank" tabindex="1"></a> <div class="admin__field-tooltip-content"><?= $block->escapeHtml(__("Merchant agrees to fulfill partial MCF orders with the selected shipping speed for the %1", $block->escapeHtml($values))) ?></div></div></div></div></td><?php endforeach; ?></tfoot></table></div></fieldset></div></div></div></div><?php $k++; $j++; endif; } ?></div></div></div><script>
    require(['jquery', 'settings'], function($, settings) {
        settings();
    });</script>